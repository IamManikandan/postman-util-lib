'use strict'

const fs = require('fs')

const JWK_KEY = require('./resources/jwk.json')
const JWK_PUBLIC_KEY = require('./resources/publicKey.json')
const PEM_PUB_KEY = fs.readFileSync('./test/resources/publicKey.pem', 'utf8')

const CLIENT_ID = 'bb2d95df-ae2e-4f22-a6ab-958d3591f1cf'
const AUD = 'http://audience.test.com'
const JWT_EXPIRED = 'eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJjbGllbnRfaWQiOiJiYjJkOTVkZi1hZTJlLTRmMjItYTZhYi05NThkMzU5MWYxY2YiLCJpc3MiOiJiYjJkOTVkZi1hZTJlLTRmMjItYTZhYi05NThkMzU5MWYxY2YiLCJhdWQiOiJodHRwOi8vYXVkaWVuY2UudGVzdC5jb20iLCJpYXQiOjE1NzQ0Mzc5NTEsIm5iZiI6MTU3NDQzNzk1MSwiZXhwIjoxNTc0NDM4NTU2LCJqdGkiOiIxZ3NBcnlBUDNDbExmdGFac1h3OFMifQ.L9cAI8CYmQ_Yig9M7axJHzzomscloXBoBOn1vB705JYjQ9nOQpOMFh5a3mKWQGQ5sRvkhtI1AeILPPYxTiD5IcqdIHEJW-_hHAWJt71mP4GITgUCFV-oFTMKqy3AyB6DgT_nf-h9PzA1M2WewcYQ1IF5AROyW7pT-aISz7iRAo2bgRcAB6rc7mdDb_WHkE9sUHy1hp5UuNuqkh-JkUC7T9PTIEw5OUmbyZ7WAPlVLolyVKQDvRSkfbzOxqJFYKySOmickkg_tWECrgIQ40PvLjMd5_bbwM71UHf-AC2PW1cHJUk7-wwvkYPh59Qs56H7vCprw3P02REfE0_ARVFTQg'
const JWT_INVALID = 'eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJjbGllbnRfaWQiOiJiYjJkOTVkZi1hZTJlLTRmMjItYTZhYi05NThkMzU5MWYxY2YiLCJpc3MiOiJiYjJkOTVkZi1hZTJlLTRmMjItYTZhYi05NThkMzU5MWYxY2YiLCJhdWQiOiJodHRwOi8vYXVkaWVuY2UudGVzdC5jb20iLCJpYXQiOjE1NzQ0Mzc5NTEsIm5iZiI6MTU3NDQzNzk1MSwiZXhwIjoxNTc0NDM4NTU2LCJqdGkiOiIxZ3NBcnlBUDNDbExmdGFac1h3OFMifQ.L9cAI8CYmQ_Yig9M7axJHzzomscloXBoBOn1vB705JYjQ9nOQpOMFh5a3mKWQGQ5sRvkhtI1AeILPPYxTiD5IcqdIHEJW-_hHAWJt71mP4GITgUCFV-oFTMKqy3AyB6DgT_nf-h9PzA1M2WewcYQ1IF5AROyW7pT-aISz7iRAo2bgRcAB6rc7mdDb_WHkE9sUHy1hp5UuNuqkh-JkUC7T9PTIEw5OUmbyZ7WAPlVLolyVKQDvRSkfbzOxqJFYKySOmickkg_tWECrgIQ40PvLjMd5_bbwM71UHf-AC2PW1cHJUk7-wwvkYPh59Qs56H7vCprw3P02REfE0_AR'
const JWT_VALID = 'eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJjbGllbnRfaWQiOiJiYjJkOTVkZi1hZTJlLTRmMjItYTZhYi05NThkMzU5MWYxY2YiLCJpc3MiOiJiYjJkOTVkZi1hZTJlLTRmMjItYTZhYi05NThkMzU5MWYxY2YiLCJhdWQiOiJodHRwOi8vYXVkaWVuY2UudGVzdC5jb20iLCJpYXQiOjE1NzQ1MjU3NzAsIm5iZiI6MTU3NDUyNTc3MCwiZXhwIjo0NTc0NTI1Nzc1LCJqdGkiOiJObGtjZnJiSndTdlpydnRGRFZyalAifQ.JDppWmFODDibkZTN_nK0XhCtdX9NhgQwhoSL0nIYRcOhL5d9PeWrv7D9b8zaWr3FAoXoJ1irEN7-ctVY8ohLb5QSwYTNE6dqh-B4r0IRCnQ2lybjND6fdKLaTAZ3rbk9l2akGqa78WGceP6zH_oHTQIG0YULbPt5zS5bgsNHdCoRWhy79VsaQ45e1o3CYwKJdyl-6cioJI4Bjb5pbC_Vuup0wEzPdOAbPLYQ6gIuM_Wio8fAwVCSHObQToQPLhuQ7ISrgJCw1J73af8Rw1w9qNzSPZZ2GWi_BiBdgPvDm-nmVgKzV9K5m1UEQa9IAhmf99ekGESeTXFBF8kAL7iXyA'
const JWT_VALID_RS384 = 'eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzM4NCJ9.eyJjbGllbnRfaWQiOiJiYjJkOTVkZi1hZTJlLTRmMjItYTZhYi05NThkMzU5MWYxY2YiLCJpc3MiOiJiYjJkOTVkZi1hZTJlLTRmMjItYTZhYi05NThkMzU5MWYxY2YiLCJhdWQiOiJodHRwOi8vYXVkaWVuY2UudGVzdC5jb20iLCJpYXQiOjE1NzQ1MTQ3NjIsIm5iZiI6MTU3NDUxNDc2MiwiZXhwIjo0NTc0NTE0NzY3LCJqdGkiOiJPNTFOQTdJbE96Q2cxWDI1aENVTGUifQ.qMObj-Vd4jqbOKo1tieebHbLoO1Vj7XtgIKxyIsjqAeYXzin6uGSg6sct73CDFvgmputy5MrQhBk_oxR5TsovLVAPrr6wSG1IwOwlaDkCKjX7n4k3LuQgRxHGzq9iQwQ6yI8hckgyFN6LOsrv1-v_XK3n9uVolzd7rCJ6gPaSZ0RcudL3vdy21YT116XpSynzISamI7vi2_yAbqAVmZZ2-n9cRq4CCkVISzRyEm2ajQ9Ug74VlA2RZo_Yl3mNKJer2IPdFF6K7mgkvqZjawoj9u_m8ow4NisMMzHRIn4VdIaSJUjxZ_oBbbHCCg5_uQ2Fah1AY09DsgR_gDRz_eBjw'
const SECRET = 'myamazingsecret'
const JWT_PAYLOAD = {
  client_id: CLIENT_ID,
  iss: CLIENT_ID,
  aud: AUD
}

function expectError (name, message) {
  return { name, message }
}

function fromBase64 (base64) {
  return base64.replace(/=/g, '').replace(/\+/g, '-').replace(/\//g, '_')
}

function encodeBuffer (buf) {
  return fromBase64(buf.toString('base64'))
}

module.exports = {
  CLIENT_ID,
  AUD,
  JWT_EXPIRED,
  JWT_INVALID,
  JWT_PAYLOAD,
  JWK_KEY,
  SECRET,
  JWK_PUBLIC_KEY,
  PEM_PUB_KEY,
  JWT_VALID,
  JWT_VALID_RS384,
  expectError,
  encodeBuffer
}
